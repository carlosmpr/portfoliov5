---
// src/components/Navbar.astro
export interface Props {
  currentPage?: string;
}

const { currentPage = "" } = Astro.props;

// Helper function to determine if a page is active
const isActive = (page: string) => {
  if (page === "/" && currentPage === "home") return true;
  if (page === "/work" && currentPage === "work") return true;
  if (page === "/about" && currentPage === "about") return true;
  if (page === "/contact" && currentPage === "contact") return true;
  return false;
};
---

<!-- Navigation -->
<nav class="fixed top-0 left-0 right-0 z-50 bg-white/80 backdrop-blur-md border-b border-gray-100" role="navigation" aria-label="Main navigation">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 py-4">
        <div class="flex items-center justify-between">
            <a href="/" class="text-lg sm:text-xl font-semibold text-gray-900 hover:text-gray-600 transition-colors flex-shrink-0">
                Carlos Polanco
            </a>
            <div class="hidden md:flex items-center space-x-6 lg:space-x-8">
                <a 
                    href="/work" 
                    class={`whitespace-nowrap transition-colors ${
                        isActive('/work') 
                            ? 'text-gray-900 font-medium' 
                            : 'text-gray-700 hover:text-gray-900'
                    }`}
                >
                    Work
                </a>
                <a 
                    href="/about" 
                    class={`whitespace-nowrap transition-colors ${
                        isActive('/about') 
                            ? 'text-gray-900 font-medium' 
                            : 'text-gray-700 hover:text-gray-900'
                    }`}
                >
                    About
                </a>
                <a 
                    href="/contact" 
                    class={`whitespace-nowrap transition-colors ${
                        isActive('/contact') 
                            ? 'text-gray-900 font-medium' 
                            : 'text-gray-700 hover:text-gray-900'
                    }`}
                >
                    Contact
                </a>
            </div>
            <!-- Mobile menu button -->
            <button id="mobile-menu-btn" class="md:hidden p-2 -mr-2 flex-shrink-0" aria-label="Toggle menu" aria-expanded="false">
                <svg id="menu-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                </svg>
                <svg id="close-icon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>
        <!-- Mobile menu -->
        <div id="mobile-menu" class="md:hidden hidden mt-4 pb-4 border-t border-gray-100">
            <nav class="flex flex-col space-y-3 pt-4" role="menu" aria-label="Mobile navigation">
                <a 
                    href="/work" 
                    class={`px-2 py-2 rounded hover:bg-gray-50 transition-colors ${
                        isActive('/work') 
                            ? 'text-gray-900 font-medium' 
                            : 'text-gray-700 hover:text-gray-900'
                    }`} 
                    role="menuitem"
                >
                    Work
                </a>
                <a 
                    href="/about" 
                    class={`px-2 py-2 rounded hover:bg-gray-50 transition-colors ${
                        isActive('/about') 
                            ? 'text-gray-900 font-medium' 
                            : 'text-gray-700 hover:text-gray-900'
                    }`} 
                    role="menuitem"
                >
                    About
                </a>
                <a 
                    href="/contact" 
                    class={`px-2 py-2 rounded hover:bg-gray-50 transition-colors ${
                        isActive('/contact') 
                            ? 'text-gray-900 font-medium' 
                            : 'text-gray-700 hover:text-gray-900'
                    }`} 
                    role="menuitem"
                >
                    Contact
                </a>
            </nav>
        </div>
    </div>
</nav>

<script>
    // Mobile menu functionality
    function initializeNavbar() {
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        const menuIcon = document.getElementById('menu-icon');
        const closeIcon = document.getElementById('close-icon');
        
        if (mobileMenuBtn && mobileMenu && menuIcon && closeIcon) {
            mobileMenuBtn.addEventListener('click', () => {
                const isExpanded = mobileMenuBtn.getAttribute('aria-expanded') === 'true';
                
                mobileMenuBtn.setAttribute('aria-expanded', String(!isExpanded));
                mobileMenu.classList.toggle('hidden');
                menuIcon.classList.toggle('hidden');
                closeIcon.classList.toggle('hidden');
            });
            
            // Close mobile menu when clicking outside
            document.addEventListener('click', (e) => {
                if (e.target instanceof Node && !mobileMenuBtn.contains(e.target) && !mobileMenu.contains(e.target)) {
                    mobileMenu.classList.add('hidden');
                    menuIcon.classList.remove('hidden');
                    closeIcon.classList.add('hidden');
                    mobileMenuBtn.setAttribute('aria-expanded', 'false');
                }
            });
        }
    }

    // Initialize when DOM is loaded
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initializeNavbar);
    } else {
        initializeNavbar();
    }
</script>